
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>ZHex - ZebraHex Editor v0.01: Project Source Code</title>
	<link rel="stylesheet" type="text/css" href="desert.css"/>
</head>
<body>
	<h2>ZHex - ZebraHex Editor v0.01</h2>
	<p>Source code file: ../ZHex/Event.pm</p>
	<pre class="prettyprint"><span class="com">#!/usr/bin/perl
</span><span class="pln">
</span><span class="lit">package</span><span class="pln"> </span><span class="atn">ZHex::Event</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">use</span><span class="pln"> </span><span class="atv">5.006</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">use</span><span class="pln"> </span><span class="kwd">strict</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">use</span><span class="pln"> </span><span class="kwd">warnings</span><span class="pln"> </span><span class="str">FATAL</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="str">&#39;all&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">use</span><span class="pln"> </span><span class="pln">ZHex::BoilerPlate</span><span class="pln"> </span><span class="str">qw(new obj_init $VERS)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">BEGIN</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">require</span><span class="pln"> </span><span class="pln">Exporter</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">our</span><span class="pln"> </span><span class="typ">$VERSION</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$VERS</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">our</span><span class="pln"> </span><span class="typ">@ISA</span><span class="pln">       </span><span class="pun">=</span><span class="pln"> </span><span class="str">qw(Exporter)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">our</span><span class="pln"> </span><span class="typ">@EXPORT</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="str">qw()</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">our</span><span class="pln"> </span><span class="typ">@EXPORT_OK</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">qw()</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Functions: Start-Up/Initialization.
</span><span class="com">#
</span><span class="com">#   _____________	___________
</span><span class="com">#   Function Name	Description
</span><span class="com">#   _____________	___________
</span><span class="com">#   init()		Global variable declarations.
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">init</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Hash reference holds callback subroutines: registered as event 
</span><span class="com">	# handlers via ZHex::EventLoop-&gt;register_callback() function.
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cb&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cb&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pun">}</span><span class="pun">;</span><span class="pln">   </span><span class="com"># DEFAULT context event handlers (callback subroutines).</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cb&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;INSERT&#39;</span><span class="pun">}</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pun">}</span><span class="pun">;</span><span class="pln">   </span><span class="com"># INSERT  context event handlers (callback subroutines).</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cb&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;SEARCH&#39;</span><span class="pun">}</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pun">}</span><span class="pun">;</span><span class="pln">   </span><span class="com"># SEARCH  context event handlers (callback subroutines).</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Functions: Event Handling Functions.
</span><span class="com">#
</span><span class="com">#   ____				___________
</span><span class="com">#   NAME				DESCRIPTION
</span><span class="com">#   ____				___________
</span><span class="com">#   register_event_callbacks()		Define callback subroutines for named functions.
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">register_event_callbacks</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;editor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objFile</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;file&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Development: Unicode character names that should be useful.
</span><span class="com">	#
</span><span class="com">	# _________			______
</span><span class="com">	# Character			Action
</span><span class="com">	# _________			______
</span><span class="com">	# &#39;BACKSPACE&#39;			Erase one character.
</span><span class="com">	# &#39;LINE FEED (LF)&#39;		Confirmation.
</span><span class="com">	# &#39;CARRIAGE RETURN (CR)&#39;	Confirmation.
</span><span class="com">	# &#39;DOLLAR SIGN&#39;			Skip to EOF (end of file).
</span><span class="pln">
</span><span class="com">	# _____________________________________________________________________________________________________
</span><span class="com">	# EVENT DRIVEN FUNCTION TABLE: TABLE OF WRAPPER FUNCTIONS PROVIDING UNIFORM NAMES/API TO EVENT HANDLERS
</span><span class="com">	#   &#39;DEFAULT&#39; Context Functions:
</span><span class="com">	# _______ _______________   ___________________ _____________________ ____________________                       _________________ 
</span><span class="com">	# CONTEXT FUNCTION NAME     KEYBOARD MAPPING    |CHAR|VKCD|VSCD|CTRL| FUNCTION DESCRIPTION                       INTERNAL FUNCTION 
</span><span class="com">	# _______ _______________   ___________________ |____|____|____|____| ____________________                       _________________ 
</span><span class="com">	# DEFAULT QUIT              [q] Key (Low Case)  |113 |  - |  - |  - | Quit                                       quit() 
</span><span class="com">	# DEFAULT CONSCURS_INVIS    SMALL LETTER V      |... |  - |  - |  - | Make (console cursor) invisible            w32cons_cursor_invisible() 
</span><span class="com">	# DEFAULT CONSCURS_VIS      CAPITAL LETTER V    |... |  - |  - |  - | Make (console cursor) visible              w32cons_cursor_visible() 
</span><span class="com">	# DEFAULT INSERT_MODE       [i] Key (Low Case)  |105 |  - |  - |  - | Insert (Begin Edit At Cursor)              insert_mode()
</span><span class="com">	# DEFAULT INSERT_MODE       [INSERT] Key        |  0 | 45 | 82 |288 | Insert                                     insert_mode() 
</span><span class="com">	# DEFAULT INSERT_MODE       [INSERT] Key        |  0 | 45 | 82 |256 | Insert                                     insert_mode() 
</span><span class="com"># &gt;&gt;&gt;	# DEFAULT WRITE_DISK        [w] Key (Low Case)  |119 |  - |  - |  - | Write  (Write Changes to Disk)             *** NOT IMPLEMENTED *** 
</span><span class="com">	# DEFAULT SEARCH_MODE       [s] Key (Low Case)  |115 |  - |  - |  - | Search (Enter String  to Search For)       search_mode()
</span><span class="com"># &gt;&gt;&gt;	# DEFAULT JUMP_TO_LINE      [L] Key (Upp Case)  |... |  - |  - |  - | Line Number (Jump To)                      *** NOT IMPLEMENTED *** 
</span><span class="com"># &gt;&gt;&gt;	# DEFAULT COPY_REGION       [CTRL][C]           |  ? |  ? |  ? |  ? | Copy Highlighted/Selected Region           *** NOT IMPLEMENTED *** 
</span><span class="com"># &gt;&gt;&gt;	# DEFAULT CUT_REGION        [CTRL][X]           |  ? |  ? |  ? |  ? | Cut  Highlighted/Selected Region           *** NOT IMPLEMENTED *** 
</span><span class="com"># &gt;&gt;&gt;	# DEFAULT PASTE_BUFFER      [CTRL][V]           |  ? |  ? |  ? |  ? | Paste Contents Of Buffer To Cursor Pos     *** NOT IMPLEMENTED *** 
</span><span class="com"># &gt;&gt;&gt;	# DEFAULT UNDO_LAST         [CTRL][Z]           |  ? |  ? |  ? |  ? | Undo Last Operation (Copy/Cut/Paste)       *** NOT IMPLEMENTED *** 
</span><span class="com">	# DEFAULT INCR_CURS_CTXT    [ENTER]  Key        | 13 |  - |  - |  - | Increse  Cursor Context/Begin Editing      curs_ctxt_incr() 
</span><span class="com">	# DEFAULT DECR_CURS_CTXT    [ESCAPE] Key        | 27 |  - |  - |  - | Decrease Cursor Context/Stop  Editing      curs_ctxt_decr() 
</span><span class="com">	# DEFAULT SCROLL_UP_1LN     [k] Key (Low Case)  |107 |  - |  - |  - | Scroll Up x 1 Line                         scroll_down_1x_line() 
</span><span class="com">	# DEFAULT SCROLL_UP_1PG     [K] Key (Upp Case)  | 75 |  - |  - |  - | Scroll Up x 1 Page                         scroll_down_1x_page() 
</span><span class="com">	# DEFAULT SCROLL_UP_1PG     [PgUp] Key          |  0 | 33 | 73 |288 | Scroll Up x 1 Page                         scroll_down_1x_page() 
</span><span class="com">	# DEFAULT SCROLL_UP_1PG     [PgUp] Key          |  0 | 33 | 73 |256 | Scroll Up x 1 Page                         scroll_down_1x_page() 
</span><span class="com">	# DEFAULT SCROLL_DOWN_1LN   [j] Key (Low Case)  |106 |  - |  - |  - | Scroll Down  x 1 Line                      scroll_down_1x_line() 
</span><span class="com">	# DEFAULT SCROLL_DOWN_1PG   [J] Key (Upp Case)  | 74 |  - |  - |  - | Scroll Down x 1 Page                       scroll_down_1x_page() 
</span><span class="com">	# DEFAULT SCROLL_DOWN_1PG   [PgDn]  Key         |  0 | 34 | 81 |288 | Scroll Down x 1 Page                       scroll_down_1x_page() 
</span><span class="com">	# DEFAULT SCROLL_DOWN_1PG   [PgDn]  Key         |  0 | 34 | 81 |256 | Scroll Down x 1 Page                       scroll_down_1x_page() 
</span><span class="com">	# DEFAULT SCROLL_DOWN_1PG   [SPACE] Key         | 32 |  - |  - |  - | Scroll Down x 1 Page                       scroll_down_1x_page() 
</span><span class="com">	# DEFAULT MOVE_CURS_BACK    [SHIFT][TAB] Keys   |  9 | 15 |  9 | 48 | Move Cursor BACK    x 1 Word/Char          curs_mv_back() 
</span><span class="com">	# DEFAULT MOVE_CURS_FORWARD [TAB] Key           |  9 | 15 |  9 | 32 | Move Cursor FORWARD x 1 Word/Char          curs_mv_fwd() 
</span><span class="com">	# DEFAULT MOVE_CURS_FORWARD [TAB] Key           |  9 | 15 |  9 |  0 | Move Cursor FORWARD x 1 Word/Char          curs_mv_fwd() 
</span><span class="com">	# DEFAULT MOVE_CURS_UP      [UP] Arrow Key      |  0 | 38 | 72 |288 | Move Cursor UP   x 1 Line                  curs_mv_up() 
</span><span class="com">	# DEFAULT MOVE_CURS_UP      [UP] Arrow Key      |  0 | 38 | 72 |256 | Move Cursor UP   x 1 Line                  curs_mv_up() 
</span><span class="com">	# DEFAULT MOVE_CURS_DOWN    [DOWN] Arrow Key    |  0 | 40 | 80 |288 | Move Cursor DOWN x 1 Line                  curs_mv_down() 
</span><span class="com">	# DEFAULT MOVE_CURS_DOWN    [DOWN] Arrow Key    |  0 | 40 | 80 |256 | Move Cursor DOWN x 1 Line                  curs_mv_down() 
</span><span class="com">	# DEFAULT MOVE_CURS_LEFT    [h] Key (Low Case)  |104 |  - |  - |  - | Move Cursor LEFT  x 1 Word/Char            curs_mv_left() 
</span><span class="com">	# DEFAULT MOVE_CURS_LEFT    [LEFT] Arrow Key    |  0 | 37 | 75 |288 | Move Cursor LEFT  x 1 Word/Char            curs_mv_left() 
</span><span class="com">	# DEFAULT MOVE_CURS_LEFT    [LEFT] Arrow Key    |  0 | 37 | 75 |256 | Move Cursor LEFT  x 1 Word/Char            curs_mv_left() 
</span><span class="com">	# DEFAULT MOVE_CURS_RIGHT   [l] Key (Low Case)  |108 |  - |  - |  - | Move Cursor RIGHT x 1 Word/Char            curs_mv_right() 
</span><span class="com">	# DEFAULT MOVE_CURS_RIGHT   [RIGHT] Arrow Key   |  0 | 39 | 77 |288 | Move Cursor RIGHT x 1 Word/Char            curs_mv_right() 
</span><span class="com">	# DEFAULT MOVE_CURS_RIGHT   [RIGHT] Arrow Key   |  0 | 39 | 77 |256 | Move Cursor RIGHT x 1 Word/Char            curs_mv_right() 
</span><span class="com">	# DEFAULT L_MOUSE_BUTTON    LEFT  Mouse Button  |  ? |  ? |  ? |  ? | Highlight line/word/byte at mouse pointer  lmouse() 
</span><span class="com">	# DEFAULT R_MOUSE_BUTTON    RIGHT Mouse Button  |  ? |  ? |  ? |  ? | ???                                        rmouse() 
</span><span class="com">	# DEFAULT DEBUG_OFF         [d] Key (Low Case)  | // | // | // | // | Disable display of debugging information   debug_on()
</span><span class="com">	# DEFAULT DEBUG_ON          [D] Key (Upp Case)  | // | // | // | // | Enable  display of debugging information   debug_off()
</span><span class="com">	# DEFAULT MOVE_BEG          [SHIFT][6] Keys: ^  | // | // | // | // | Move cursor to first byte                  move_to_beginning() 
</span><span class="com">	# DEFAULT MOVE_END          [SHIFT][4] Keys: $  | // | // | // | // | Move cursor to last byte                   move_to_end() 
</span><span class="com">	# DEFAULT VSTRETCH          [CTRL][UP] Arrow key|  0 | 38 | 72 | 264| Stretch the editor display verically       vstretch()
</span><span class="com">	# DEFAULT VCOMPRESS         [CTRL][DN] Arrow key|  0 | 40 | 80 | 264| Compress the editor display vertcially     vcompress()
</span><span class="pln">
	</span><span class="kwd">foreach</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$evt_reg</span><span class="pln"> 
</span><span class="pln">	</span><span class="pun">(</span><span class="pln"> </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;QUIT&#39;</span><span class="pun">,</span><span class="pln">              </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">quit</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;CONSCURS_INVIS&#39;</span><span class="pun">,</span><span class="pln">    </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_invisible</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;CONSCURS_VIS&#39;</span><span class="pun">,</span><span class="pln">      </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_visible</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;INSERT_MODE&#39;</span><span class="pun">,</span><span class="pln">       </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">insert_mode</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;WRITE_DISK&#39;</span><span class="pun">,</span><span class="pln">        </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SEARCH_MODE&#39;</span><span class="pun">,</span><span class="pln">       </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">search_mode</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;JUMP_TO_LINE&#39;</span><span class="pun">,</span><span class="pln">      </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;COPY_REGION&#39;</span><span class="pun">,</span><span class="pln">       </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;CUT_REGION&#39;</span><span class="pun">,</span><span class="pln">        </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;PASTE_BUFFER&#39;</span><span class="pun">,</span><span class="pln">      </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;UNDO_LAST&#39;</span><span class="pun">,</span><span class="pln">         </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SCROLL_UP_1LN&#39;</span><span class="pun">,</span><span class="pln">     </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="typ">scroll_up_1x_line</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SCROLL_UP_1PG&#39;</span><span class="pun">,</span><span class="pln">     </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="typ">scroll_up_1x_page</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SCROLL_DOWN_1LN&#39;</span><span class="pun">,</span><span class="pln">   </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="typ">scroll_down_1x_line</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SCROLL_DOWN_1PG&#39;</span><span class="pun">,</span><span class="pln">   </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="typ">scroll_down_1x_page</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;INCR_CURS_CTXT&#39;</span><span class="pun">,</span><span class="pln">    </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">curs_ctxt_incr</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;DECR_CURS_CTXT&#39;</span><span class="pun">,</span><span class="pln">    </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">curs_ctxt_decr</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;MOVE_CURS_FORWARD&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">curs_mv_fwd</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;MOVE_CURS_BACK&#39;</span><span class="pun">,</span><span class="pln">    </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">curs_mv_back</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;MOVE_CURS_UP&#39;</span><span class="pun">,</span><span class="pln">      </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">curs_mv_up</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;MOVE_CURS_DOWN&#39;</span><span class="pun">,</span><span class="pln">    </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">curs_mv_down</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;MOVE_CURS_LEFT&#39;</span><span class="pun">,</span><span class="pln">    </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">curs_mv_left</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;MOVE_CURS_RIGHT&#39;</span><span class="pun">,</span><span class="pln">   </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">curs_mv_right</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;L_MOUSE_BUTTON&#39;</span><span class="pun">,</span><span class="pln">    </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">lmouse</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;R_MOUSE_BUTTON&#39;</span><span class="pun">,</span><span class="pln">    </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">rmouse</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;DEBUG_OFF&#39;</span><span class="pun">,</span><span class="pln">         </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">debug_off</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;DEBUG_ON&#39;</span><span class="pun">,</span><span class="pln">          </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">debug_on</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;MOVE_BEG&#39;</span><span class="pun">,</span><span class="pln">          </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">move_to_beginning</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;MOVE_END&#39;</span><span class="pun">,</span><span class="pln">          </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">move_to_end</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;VSTRETCH&#39;</span><span class="pun">,</span><span class="pln">          </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">vstretch</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;VCOMPRESS&#39;</span><span class="pun">,</span><span class="pln">         </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">vcompress</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# _____________________________________________________________________________________________________
</span><span class="com">	# EVENT DRIVEN FUNCTION TABLE: TABLE OF WRAPPER FUNCTIONS PROVIDING UNIFORM NAMES/API TO EVENT HANDLERS
</span><span class="com">	#   &#39;INSERT&#39; Context Functions:
</span><span class="com">	# _______________   ___________________ _____________________ ____________________                       _________________ 
</span><span class="com">	# FUNCTION NAME     KEYBOARD MAPPING    |CHAR|VKCD|VSCD|CTRL| FUNCTION DESCRIPTION                       INTERNAL FUNCTION 
</span><span class="com">	# _______________   ___________________ |____|____|____|____| ____________________                       _________________ 
</span><span class="com">	# INSERT_ESCAPE     [ESCAPE] Key        | 27 |  - |  - |  - | Decrease Cursor Context/Stop  Editing      insert_escape() 
</span><span class="com">	# INSERT_BACKSPACE  [BACKSPACE] Key     |    |    |    |    | Delete Character Left Of Cursor            insert_backspace()
</span><span class="com">	# INSERT_CHAR       &lt;ANY KEY&gt;           |    |    |    |    | Insert Character At Cursor                 insert_char()
</span><span class="com">	# INSERT_ENTER      [ENTER] Key         |    |    |    |    | Finish Inserting Character(s)              insert_enter()
</span><span class="com">	# INSERT_L_ARROW    [LEFT ARROW] Key    |    |    |    |    | Move Cursor To The Left One Character      insert_l_arrow()
</span><span class="com">	# INSERT_R_ARROW    [RIGHT ARROW] Key   |    |    |    |    | Move Cursor To The Right One Character     insert_r_arrow()
</span><span class="pln">
	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;INSERT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;INSERT_BACKSPACEINSERT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">insert_backspace</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;INSERT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;INSERT_CHAR&#39;</span><span class="pun">,</span><span class="pln">            </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">insert_char</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;INSERT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;INSERT_ENTER&#39;</span><span class="pun">,</span><span class="pln">           </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">insert_enter</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;INSERT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;INSERT_ESCAPE&#39;</span><span class="pun">,</span><span class="pln">          </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">insert_escape</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;INSERT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;INSERT_L_ARROW&#39;</span><span class="pun">,</span><span class="pln">         </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">insert_l_arrow</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;INSERT&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;INSERT_R_ARROW&#39;</span><span class="pun">,</span><span class="pln">         </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">insert_r_arrow</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# _____________________________________________________________________________________________________
</span><span class="com">	# EVENT DRIVEN FUNCTION TABLE: TABLE OF WRAPPER FUNCTIONS PROVIDING UNIFORM NAMES/API TO EVENT HANDLERS
</span><span class="com">	#   &#39;SEARCH&#39; Context Functions
</span><span class="com">	# _______________   ___________________ _____________________ ____________________                       _________________ 
</span><span class="com">	# FUNCTION NAME     KEYBOARD MAPPING    |CHAR|VKCD|VSCD|CTRL| FUNCTION DESCRIPTION                       INTERNAL FUNCTION 
</span><span class="com">	# _______________   ___________________ |____|____|____|____| ____________________                       _________________ 
</span><span class="com">	# SEARCH_BACKSPACE  [BACKSPACE] Key     | 27 |  - |  - |  - | ...                                        search_backspace()
</span><span class="com">	# SEARCH_CHAR       &lt;ANY KEY&gt;           | 27 |  - |  - |  - | ...                                        search_char()
</span><span class="com">	# SEARCH_ENTER      [ENTER] Key         | 27 |  - |  - |  - | ...                                        search_enter()
</span><span class="com">	# SEARCH_ESCAPE     [ESCAPE] Key        | 27 |  - |  - |  - | Decrease Cursor Context/Stop  Editing      search_escape() 
</span><span class="com">	# SEARCH_L_ARROW    [LEFT ARROW] Key    | 27 |  - |  - |  - | ...                                        search_l_arrow()
</span><span class="com">	# SEARCH_R_ARROW    [RIGHT ARROW] Key   | 27 |  - |  - |  - | ...                                        search_r_arrow()
</span><span class="pln">
	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;SEARCH&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SEARCH_BACKSPACE&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">search_backspace</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;SEARCH&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SEARCH_CHAR&#39;</span><span class="pun">,</span><span class="pln">      </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">search_char</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;SEARCH&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SEARCH_ENTER&#39;</span><span class="pun">,</span><span class="pln">     </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">search_enter</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;SEARCH&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SEARCH_ESCAPE&#39;</span><span class="pun">,</span><span class="pln">    </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">search_escape</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;SEARCH&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SEARCH_L_ARROW&#39;</span><span class="pun">,</span><span class="pln">   </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">search_l_arrow</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pun">,</span><span class="pln">
</span><span class="pln">	  </span><span class="pun">[</span><span class="pln"> </span><span class="str">&#39;SEARCH&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;SEARCH_R_ARROW&#39;</span><span class="pun">,</span><span class="pln">   </span><span class="lit">sub</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">search_r_arrow</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">]</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# print $evt_reg-&gt;[0] . &quot;\t&quot; . $evt_reg-&gt;[1] . &quot;\t&quot; . $evt_reg-&gt;[2] . &quot;\n&quot;;
</span><span class="pln">
		</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="typ">register_callback</span><span class="pln"> </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;ctxt&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$evt_reg</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="atv">0</span><span class="pun">]</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;evt_nm&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$evt_reg</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="atv">1</span><span class="pun">]</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;evt_cb&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$evt_reg</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="atv">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Functions: &#39;DEFAULT&#39; context event handlers.
</span><span class="com">#
</span><span class="com">#   ____			__________	___________
</span><span class="com">#   NAME			Event Name	DESCRIPTION
</span><span class="com">#   ____			__________	___________
</span><span class="com">#   debug_off()			DEBUG_OFF	Disable display of debugging information.
</span><span class="com">#   debug_on()			DEBUG_ON	Enable  display of debugging information.
</span><span class="com">#   insert_mode()		INSERT_MODE	Switch to &#39;INSERT&#39; context.
</span><span class="com">#   search_mode()		SEARCH_MODE	Switch to &#39;SEARCH&#39; context.
</span><span class="com">#   move_to_beginning()		MOVE_BEG	Move to first byte of file.
</span><span class="com">#   move_to_end()		MOVE_END	Move to last  byte of file.
</span><span class="com">#   quit()			QUIT		Break out of event_loop(), clean up, exit().
</span><span class="com">#   vstretch()			VSTRETCH	Stretch the editor display vertically.
</span><span class="com">#   vcompress()                 VCOMPRESS       Compress the editor display vertically.
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">debug_off</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">foreach</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$d_element_nm</span><span class="pln"> 
</span><span class="pln">	  </span><span class="pun">(</span><span class="str">&#39;dbg_mouse_evt&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_keybd_evt&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_unmatched_evt&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_curs&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_display&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_count&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_console&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;errmsg_queue&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$d_element_nm</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;enabled&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">debug_on</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">foreach</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$d_element_nm</span><span class="pln"> 
</span><span class="pln">	  </span><span class="pun">(</span><span class="str">&#39;dbg_mouse_evt&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_keybd_evt&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_unmatched_evt&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_curs&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_display&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_count&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;dbg_console&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="str">&#39;errmsg_queue&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$d_element_nm</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;enabled&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">1</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">insert_mode</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">     </span><span class="com"># Used.</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">      </span><span class="com"># Used.</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">     </span><span class="com"># Used.</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;editor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">      </span><span class="com"># Used.</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">   </span><span class="com"># Used.</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Switch context to &#39;INSERT&#39;.
</span><span class="pln">
	</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CTXT&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;INSERT&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Change cursor context to 3 (insert mode).
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">3</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">3</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Define variables used to manage the insert user interface.
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_str&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Move Win32 console cursor to insert position.
</span><span class="com">	# Make Win32 console cursor visible.
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$xpos</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$ypos</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">	  </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">dsp_coord</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;curs_pos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	       </span><span class="str">&#39;dsp_pos&#39;</span><span class="pln">  </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	       </span><span class="str">&#39;dsp_ypad&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	       </span><span class="str">&#39;dsp_xpad&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_move</span><span class="pln"> 
</span><span class="pln">	  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;xpos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$xpos</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	     </span><span class="str">&#39;ypos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$ypos</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_visible</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">search_mode</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Switch context to &#39;SEARCH&#39;.
</span><span class="pln">
	</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CTXT&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;SEARCH&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Draw search box over the top of the editor display.
</span><span class="pln">
	</span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_box&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;enabled&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">1</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Define variables used to manage the search user interface.
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Store the value of &#39;curs_ctxt&#39; so that it can be restored.
</span><span class="com">	# Set cursor context to 3 (make it disappear while search box displayed).
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">3</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Move Win32 console cursor to beginning of text string position (within search box).
</span><span class="com">	# Make Win32 console cursor visible.
</span><span class="pln">
	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_move</span><span class="pln"> 
</span><span class="pln">	  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;xpos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_box&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;e_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="atv">4</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	     </span><span class="str">&#39;ypos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_box&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;e_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="atv">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_visible</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">move_to_beginning</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;editor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">move_to_end</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;editor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objFile</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;file&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objFile</span><span class="pun">-&gt;</span><span class="typ">file_len</span><span class="pun">(</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_column&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">	
		</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">		  </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">align_line_boundary</span><span class="pln"> 
</span><span class="pln">		     </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;pos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objFile</span><span class="pun">-&gt;</span><span class="typ">file_len</span><span class="pun">(</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> 
</span><span class="pln">		   </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_column&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> 
</span><span class="pln">		       </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">	
		</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objFile</span><span class="pun">-&gt;</span><span class="typ">file_len</span><span class="pun">(</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">2</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">quit</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FLAG_QUIT&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">1</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">vstretch</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">     </span><span class="com"># Used.</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;editor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">      </span><span class="com"># Used.</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">   </span><span class="com"># Used.</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objFile</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;file&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">        </span><span class="com"># Used.</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_column&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">(</span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_height&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">(</span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
</span><span class="pln">	      </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;column_titles&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;e_height&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
</span><span class="pln">	      </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;column_titles&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;vpad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
</span><span class="pln">	      </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sep&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;e_height&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
</span><span class="pln">	      </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sep&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;vpad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
</span><span class="pln">	      </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;errmsg_queue&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;e_height&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
</span><span class="pln">	      </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;errmsg_queue&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;vpad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="typ">set_sz_column</span><span class="pln"> 
</span><span class="pln">		  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;sz_column&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_column&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> 
</span><span class="pln">		      </span><span class="pun">(</span><span class="typ">$objFile</span><span class="pun">-&gt;</span><span class="typ">file_len</span><span class="pun">(</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> 
</span><span class="pln">			 </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_column&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> 
</span><span class="pln">		            </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="typ">set_dsp_pos</span><span class="pln"> 
</span><span class="pln">			  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;dsp_pos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> 
</span><span class="pln">			                   </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="typ">adjust_display</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">vcompress</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;editor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_column&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="typ">set_sz_column</span><span class="pln"> 
</span><span class="pln">		  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;sz_column&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_column&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> 
</span><span class="pln">	       </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
</span><span class="pln">	        </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_column&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">curs_mv_up</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="typ">adjust_display</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Functions: &#39;INSERT&#39; context event handlers.
</span><span class="com">#
</span><span class="com">#   ____			___________
</span><span class="com">#   NAME			DESCRIPTION
</span><span class="com">#   ____			___________
</span><span class="com">#   insert_backspace()		Delete character to the left of the cursor.
</span><span class="com">#   insert_char()		Insert character at the cursor position.
</span><span class="com">#   insert_enter()		Begin search using the search string specified by user.
</span><span class="com">#   insert_escape()		Cancel search operation, switch context to &#39;DEFAULT&#39;.
</span><span class="com">#   insert_l_arrow()		Move the cursor to the left within the text string inside the search box.
</span><span class="com">#   insert_r_arrow()		Move the cursor to the right within the text string inside the search box.
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">insert_backspace</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	          </span><span class="pun">!</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">s/.$//</span><span class="pun">;</span><span class="pln">   </span><span class="com"># Remove last character from string.</span><span class="pln">
</span><span class="pln">		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;insert_pos&#39;</span><span class="pun">}</span><span class="pun">--</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_move</span><span class="pln">
</span><span class="pln">		  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;xpos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		     </span><span class="str">&#39;ypos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln">  </span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">insert_char</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDebug</span><span class="pln">     </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;debug&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;editor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objFile</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;file&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$char</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">chr</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;evt&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="atv">5</span><span class="pun">]</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# If inserting in hex mode, make sure character is: 1 - 9 or A - F.
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$char</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^[1234567890abcdefABCDEF]$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objDebug</span><span class="pun">-&gt;</span><span class="typ">errmsg</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Bad value for char: &#39;&quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$char</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;&#39;.&quot;</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">undef</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# If inserting in hex mode, check to see if the first character 
</span><span class="com">	# (of a two character string) was already entered.
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;first_hex_char&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;first_hex_char&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;first_hex_char&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^[1234567890abcdefABCDEF]$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;first_hex_char&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$char</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">my</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$xpos</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$ypos</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">		  </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">dsp_coord</span><span class="pln"> 
</span><span class="pln">		    </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;curs_pos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		       </span><span class="str">&#39;dsp_pos&#39;</span><span class="pln">  </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		       </span><span class="str">&#39;dsp_ypad&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		       </span><span class="str">&#39;dsp_xpad&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$xpos</span><span class="pun">++</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_move</span><span class="pln"> 
</span><span class="pln">		  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;xpos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$xpos</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		     </span><span class="str">&#39;ypos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$ypos</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$ord</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">hex</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;first_hex_char&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$char</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$byte</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">chr</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$ord</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;first_hex_char&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Insert character into place in file (at cursor position).
</span><span class="pln">
		</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">		  </span><span class="typ">$objFile</span><span class="pun">-&gt;</span><span class="typ">insert_str</span><span class="pln"> 
</span><span class="pln">		    </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;pos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		       </span><span class="str">&#39;str&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$byte</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			    </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		     </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objDebug</span><span class="pun">-&gt;</span><span class="typ">errmsg</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Call to insert_str() returned w/ success.&quot;</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> 
</span><span class="pln">		</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objDebug</span><span class="pun">-&gt;</span><span class="typ">errmsg</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Call to insert_str() returned w/ failure.&quot;</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		       </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">undef</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Update editor cursor position.
</span><span class="pln">
		</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pun">++</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Update Win32 Console cursor position.
</span><span class="pln">
		</span><span class="kwd">my</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$xpos</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$ypos</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">		  </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">dsp_coord</span><span class="pln"> 
</span><span class="pln">		    </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;curs_pos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		       </span><span class="str">&#39;dsp_pos&#39;</span><span class="pln">  </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		       </span><span class="str">&#39;dsp_ypad&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		       </span><span class="str">&#39;dsp_xpad&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_move</span><span class="pln"> 
</span><span class="pln">		  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;xpos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$xpos</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		     </span><span class="str">&#39;ypos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$ypos</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">insert_enter</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Switch context to &#39;DEFAULT&#39;.
</span><span class="pln">
	</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CTXT&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Change cursor context to 2 (byte mode).
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">2</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">2</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Set Win32 console cursor to invisible.
</span><span class="com">	# Move Win32 console cursor to top/left corner of display console.
</span><span class="pln">
	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_invisible</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_tleft_dsp</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">insert_escape</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Switch context to &#39;DEFAULT&#39;.
</span><span class="pln">
	</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CTXT&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Change cursor context to 2 (byte mode).
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">2</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">2</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Set Win32 console cursor to invisible.
</span><span class="com">	# Move Win32 console cursor to top/left corner of display console.
</span><span class="pln">
	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_invisible</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_tleft_dsp</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">insert_l_arrow</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# ...
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">insert_r_arrow</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# ...
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Functions: &#39;SEARCH&#39; context event handlers.
</span><span class="com">#
</span><span class="com">#   ____			___________
</span><span class="com">#   NAME			DESCRIPTION
</span><span class="com">#   ____			___________
</span><span class="com">#   search_backspace()
</span><span class="com">#   search_char()
</span><span class="com">#   search_enter()
</span><span class="com">#   search_escape()
</span><span class="com">#   search_l_arrow()
</span><span class="com">#   search_r_arrow()
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">search_backspace</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	         </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="atv">0</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="kwd">length</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="kwd">substr</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> </span><span class="atv">1</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">s/.$//</span><span class="pun">;</span><span class="pln">   </span><span class="com"># Remove last character from string.</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pun">--</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Update position of Win32 console cursor.
</span><span class="pln">
		</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_move</span><span class="pln">
</span><span class="pln">		  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;xpos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		     </span><span class="str">&#39;ypos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln">  </span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">search_char</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$char</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">chr</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;evt&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="atv">5</span><span class="pun">]</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	         </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">length</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">substr</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> </span><span class="atv">0</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$char</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">.=</span><span class="pln"> </span><span class="typ">$char</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pun">++</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Update position of Win32 console cursor.
</span><span class="pln">
	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_move</span><span class="pln"> 
</span><span class="pln">	  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;xpos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	     </span><span class="str">&#39;ypos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln">  </span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">search_enter</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDebug</span><span class="pln">     </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;debug&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;editor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objFile</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;file&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	         </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# index STR, SUBSTR, POSITION
</span><span class="com">		# index STR, SUBSTR
</span><span class="com">		#   The index function searches for one string within another, but
</span><span class="com">		#   without the wildcard-like behavior of a full regular-expression
</span><span class="com">		#   pattern match. It returns the position of the first occurrence
</span><span class="com">		#   of SUBSTR in STR at or after POSITION. If POSITION is omitted,
</span><span class="com">		#   starts searching from the beginning of the string. POSITION
</span><span class="com">		#   before the beginning of the string or after its end is treated
</span><span class="com">		#   as if it were the beginning or the end, respectively. POSITION
</span><span class="com">		#   and the return value are based at zero. If the substring is not
</span><span class="com">		#   found, &quot;index&quot; returns -1.
</span><span class="pln">
		</span><span class="typ">$objDebug</span><span class="pun">-&gt;</span><span class="typ">errmsg</span><span class="pln"> 
</span><span class="pln">		  </span><span class="pun">(</span><span class="str">&quot;Call to function file_bytes() returned w/ &#39;&quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> 
</span><span class="pln">		   </span><span class="kwd">scalar</span><span class="pln"> </span><span class="pun">(</span><span class="var">@</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objFile</span><span class="pun">-&gt;</span><span class="typ">file_bytes</span><span class="pln"> 
</span><span class="pln">		                </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;ofs&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		                   </span><span class="str">&#39;len&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$objFile</span><span class="pun">-&gt;</span><span class="typ">file_len</span><span class="pun">(</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;&#39; bytes.&quot;</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Search for user specified string within file.
</span><span class="pln">
		</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">		  </span><span class="kwd">index</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="kwd">join</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="var">@</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$objFile</span><span class="pun">-&gt;</span><span class="typ">file_bytes</span><span class="pln"> 
</span><span class="pln">		                        </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;ofs&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		                           </span><span class="str">&#39;len&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$objFile</span><span class="pun">-&gt;</span><span class="typ">file_len</span><span class="pun">(</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		         </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		         </span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="atv">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">			# Move cursor to the beginning position where string was matched.
</span><span class="pln">
			</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$rv</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">			# Set cursor context to &#39;2&#39; (byte context).
</span><span class="pln">
			</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">2</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">			# If cursor is positioned beyond the editor display, 
</span><span class="com">			# move the editor display so that cursor is in view.
</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> 
</span><span class="pln">			         </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> 
</span><span class="pln">			            </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_column&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">
</span><span class="pln">			                </span><span class="kwd">length</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
				</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">			# Restore cursor context to previous value (or byte mode).
</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">				   </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^[012]$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
				</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">			</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^[012]$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
				</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">2</span><span class="pun">;</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Restore cursor context to previous value (or byte mode).
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">		    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			   </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^[012]$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^[012]$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">2</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Switch context to &#39;DEFAULT&#39;.
</span><span class="pln">
	</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CTXT&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Disable search box display.
</span><span class="pln">
	</span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_box&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;enabled&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Set Win32 console cursor to invisible.
</span><span class="com">	# Move Win32 console cursor to top/left corner of display console.
</span><span class="pln">
	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_invisible</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_tleft_dsp</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Erase variables used to manage search user interface.
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">search_escape</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Switch context to &#39;DEFAULT&#39;.
</span><span class="pln">
	</span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CTXT&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;DEFAULT&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Restore cursor context to previous value (or 2: byte mode).
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^[012]$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt_prev&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^[012]$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">2</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Disable search box display.
</span><span class="pln">
	</span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_elements&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_box&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;enabled&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Set Win32 console cursor to invisible.
</span><span class="com">	# Move Win32 console cursor to top/left corner of display console.
</span><span class="pln">
	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_invisible</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_tleft_dsp</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Erase variables used to manage search user interface.
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">0</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">search_l_arrow</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	          </span><span class="pun">!</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	            </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	            </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="atv">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pun">--</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Update position of Win32 console cursor.
</span><span class="pln">
		</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_move</span><span class="pln">
</span><span class="pln">		  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;xpos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		     </span><span class="str">&#39;ypos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln">  </span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">search_r_arrow</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objConsole</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;console&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	          </span><span class="pun">!</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	            </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	            </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">length</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_pos&#39;</span><span class="pun">}</span><span class="pun">++</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Update position of Win32 console cursor.
</span><span class="pln">
		</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="typ">w32cons_cursor_move</span><span class="pln">
</span><span class="pln">		  </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;xpos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		     </span><span class="str">&#39;ypos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln">  </span><span class="typ">$objConsole</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Functions: Display element routines.
</span><span class="com">#
</span><span class="com">#   ____		___________
</span><span class="com">#   NAME		DESCRIPTION
</span><span class="com">#   ____		___________
</span><span class="com">#   search_box()	Return a &quot;search box&quot; formatted for display console.
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">search_box</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Display box 140 chars wide x 12 chars tall.
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">@search_box</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">	  </span><span class="pun">(</span><span class="pln"> </span><span class="str">&#39;_&#39;</span><span class="pln"> </span><span class="pun">x</span><span class="pln"> </span><span class="atv">140</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	    </span><span class="str">&#39;|&#39;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">(</span><span class="str">&#39; &#39;</span><span class="pln"> </span><span class="pun">x</span><span class="pln"> </span><span class="atv">138</span><span class="pun">)</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&#39;|&#39;</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	    </span><span class="str">&#39;_&#39;</span><span class="pln"> </span><span class="pun">x</span><span class="pln"> </span><span class="atv">140</span><span class="pln"> </span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# If search string already defined, add it to the search box display.
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	          </span><span class="pun">!</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$replaced_str</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">		  </span><span class="kwd">substr</span><span class="pln"> </span><span class="typ">$search_box</span><span class="pun">[</span><span class="atv">1</span><span class="pun">]</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		         </span><span class="atv">2</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		         </span><span class="kwd">length</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		         </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;search_str&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="var">\</span><span class="typ">@search_box</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">END</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="atv">1</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">__END__</span><span class="pln">
</span><span class="com">

</span><span class="com">=head1 NAME

ZHex::Event (ZHex/Event.pm) - Event Module, ZebraHex Editor.

=head1 VERSION

Version 0.01

=cut
</span><span class="com">
our $VERSION = &#39;0.01&#39;;

</span><span class="com">=head1 SYNOPSIS

ZHex::Event contains event handler callback subroutines for the ZebraHex 
Editor. Events (in this context) are almost entirely related user 
actions within the interface provided by the hex editor (accessed via 
the console).

Usage:

    use ZHex;

    my $editorObj = ZHex-&gt;new();
    ...

=head1 EXPORT

No functions are exported.

=head1 SUBROUTINES/METHODS

=head2 debug_off
Method debug_off()...
= cut

=head2 debug_on
Method debug_on()...
= cut

=head2 init
Method init()...
= cut

=head2 insert_backspace
Method insert_backspace()...
= cut

=head2 insert_char
Method insert_char()...
= cut

=head2 insert_enter
Method insert_enter()...
= cut

=head2 insert_escape
Method insert_escape()...
= cut

=head2 insert_l_arrow
Method insert_l_arrow()...
= cut

=head2 insert_mode
Method insert_mode()...
= cut

=head2 insert_r_arrow
Method insert_r_arrow()...
= cut

=head2 move_to_beginning
Method move_to_beginning()...
= cut

=head2 move_to_end
Method move_to_end()...
= cut

=head2 quit
Method quit()...
= cut

=head2 register_event_callbacks
Method register_event_callbacks()...
= cut

=head2 search_backspace
Method search_backspace()...
= cut

=head2 search_box
Method search_box()...
= cut

=head2 search_char
Method search_char()...
= cut

=head2 search_enter
Method search_enter()...
= cut

=head2 search_escape
Method search_escape()...
= cut

=head2 search_l_arrow
Method search_l_arrow()...
= cut

=head2 search_mode
Method search_mode()...
= cut

=head2 search_r_arrow
Method search_r_arrow()...
= cut

=head2 vstretch
Method vstretch()...
= cut

=head2 vcompress
Method vcompress()...
= cut

=head1 AUTHOR

Double Z, C&lt;&lt; &lt;zacharyz at gmail.com&gt; &gt;&gt;

=head1 BUGS

Please report any bugs or feature requests to C&lt;bug-ZHex at rt.cpan.org&gt;, or through
the web interface at L&lt;http://rt.cpan.org/NoAuth/ReportBug.html?Queue=ZHex&gt;.  I will be notified, and then you&#39;ll
automatically be notified of progress on your bug as I make changes.

=head1 SUPPORT

You can find documentation for this module with the perldoc command.

    perldoc ZHex

You can also look for information at:

=over 4

=item * RT: CPAN&#39;s request tracker (report bugs here)

L&lt;http://rt.cpan.org/NoAuth/Bugs.html?Dist=ZHex&gt;

=item * AnnoCPAN: Annotated CPAN documentation

L&lt;http://annocpan.org/dist/ZHex&gt;

=item * CPAN Ratings

L&lt;http://cpanratings.perl.org/d/ZHex&gt;

=item * Search CPAN

L&lt;http://search.cpan.org/dist/ZHex/&gt;

=back

=head1 ACKNOWLEDGEMENTS

=head1 LICENSE AND COPYRIGHT

Copyright 2014 Double Z.

This program is free software; you can redistribute it and/or modify it
under the terms of the the Artistic License (2.0). You may obtain a
copy of the full license at:

L&lt;http://www.perlfoundation.org/artistic_license_2_0&gt;

Any use, modification, and distribution of the Standard or Modified
Versions is governed by this Artistic License. By using, modifying or
distributing the Package, you accept this license. Do not use, modify,
or distribute the Package, if you do not accept this license.

If your Modified Version has been derived from a Modified Version made
by someone other than you, you are nevertheless required to ensure that
your Modified Version complies with the requirements of this license.

This license does not grant you the right to use any trademark, service
mark, tradename, or logo of the Copyright Holder.

This license includes the non-exclusive, worldwide, free-of-charge
patent license to make, have made, use, offer to sell, sell, import and
otherwise transfer the Package with respect to any patent claims
licensable by the Copyright Holder that are necessarily infringed by the
Package. If you institute patent litigation (including a cross-claim or
counterclaim) against any party alleging that the Package constitutes
direct or contributory patent infringement, then this Artistic License
to you shall terminate on the date that such litigation is filed.

Disclaimer of Warranty: THE PACKAGE IS PROVIDED BY THE COPYRIGHT HOLDER
AND CONTRIBUTORS &quot;AS IS&#39; AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES.
THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
PURPOSE, OR NON-INFRINGEMENT ARE DISCLAIMED TO THE EXTENT PERMITTED BY
YOUR LOCAL LAW. UNLESS REQUIRED BY LAW, NO COPYRIGHT HOLDER OR
CONTRIBUTOR WILL BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, OR
CONSEQUENTIAL DAMAGES ARISING IN ANY WAY OUT OF THE USE OF THE PACKAGE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

=cut
</span><span class="com">
1;

</span></pre>
</body>
</html>

