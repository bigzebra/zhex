
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>ZHex - ZebraHex Editor v0.01: Project Source Code</title>
	<link rel="stylesheet" type="text/css" href="desert.css"/>
</head>
<body>
	<h2>ZHex - ZebraHex Editor v0.01</h2>
	<p>ZHex Editor source code filename: ../ZHex/Console.pm</p>
	<div><pre class="prettyprint"><span class="com">#!/usr/bin/perl
</span><span class="pln">
</span><span class="lit">package</span><span class="pln"> </span><span class="atn">ZHex::Console</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">use</span><span class="pln"> </span><span class="atv">5.006</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">use</span><span class="pln"> </span><span class="kwd">strict</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">use</span><span class="pln"> </span><span class="kwd">warnings</span><span class="pln"> </span><span class="str">FATAL</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="str">&#39;all&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">use</span><span class="pln"> </span><span class="pln">ZHex::BoilerPlate</span><span class="pln"> </span><span class="str">qw(new obj_init $VERS)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">BEGIN</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">require</span><span class="pln"> </span><span class="pln">Exporter</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">our</span><span class="pln"> </span><span class="typ">$VERSION</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$VERS</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">our</span><span class="pln"> </span><span class="typ">@ISA</span><span class="pln">       </span><span class="pun">=</span><span class="pln"> </span><span class="str">qw(Exporter)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">our</span><span class="pln"> </span><span class="typ">@EXPORT</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="str">qw()</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">our</span><span class="pln"> </span><span class="typ">@EXPORT_OK</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">qw()</span><span class="pun">;</span><span class="pln"> 
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">use</span><span class="pln"> </span><span class="pln">Win32::Console</span><span class="pln"> 
</span><span class="pln"> </span><span class="str">qw(BACKGROUND_BLUE 
    BACKGROUND_GREEN 
    BACKGROUND_INTENSITY 
    BACKGROUND_RED 
    CAPSLOCK_ON 
    CONSOLE_TEXTMODE_BUFFER 
    CTRL_BREAK_EVENT 
    CTRL_C_EVENT 
    ENABLE_ECHO_INPUT 
    ENABLE_LINE_INPUT 
    ENABLE_MOUSE_INPUT 
    ENABLE_PROCESSED_INPUT 
    ENABLE_PROCESSED_OUTPUT 
    ENABLE_WINDOW_INPUT 
    ENABLE_WRAP_AT_EOL_OUTPUT 
    ENHANCED_KEY 
    FILE_SHARE_READ 
    FILE_SHARE_WRITE 
    FOREGROUND_BLUE 
    FOREGROUND_GREEN 
    FOREGROUND_INTENSITY 
    FOREGROUND_RED 
    GENERIC_READ 
    GENERIC_WRITE 
    LEFT_ALT_PRESSED 
    LEFT_CTRL_PRESSED 
    NUMLOCK_ON 
    RIGHT_ALT_PRESSED 
    RIGHT_CTRL_PRESSED 
    SCROLLLOCK_ON 
    SHIFT_PRESSED 
    STD_INPUT_HANDLE 
    STD_OUTPUT_HANDLE 
    STD_ERROR_HANDLE 
    @CONSOLE_COLORS 
    $ATTR_NORMAL 
    $ATTR_INVERSE 
    $FG_BLACK 
    $FG_BROWN 
    $FG_CYAN 
    $FG_GRAY 
    $FG_BLUE 
    $FG_GREEN 
    $FG_LIGHTBLUE 
    $FG_LIGHTCYAN 
    $FG_LIGHTGRAY 
    $FG_LIGHTGREEN 
    $FG_LIGHTMAGENTA 
    $FG_LIGHTRED 
    $FG_MAGENTA 
    $FG_RED 
    $FG_WHITE 
    $FG_YELLOW 
    $BG_BLACK 
    $BG_BLUE 
    $BG_BROWN 
    $BG_CYAN 
    $BG_GRAY 
    $BG_GREEN 
    $BG_LIGHTBLUE 
    $BG_LIGHTCYAN 
    $BG_LIGHTGRAY 
    $BG_LIGHTGREEN 
    $BG_LIGHTMAGENTA 
    $BG_LIGHTRED 
    $BG_MAGENTA 
    $BG_RED 
    $BG_WHITE 
    $BG_YELLOW)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Functions: Start-up/initialization.
</span><span class="com">#
</span><span class="com">#   _____________	___________
</span><span class="com">#   Function Name	Description
</span><span class="com">#   _____________	___________
</span><span class="com">#   init()		Global variable declarations
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">init</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# References to Win32::Console objects stored in keys.
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># Console handle objects ala Win32::Console </span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS_IN&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># Console handle objects ala Win32::Console </span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Various Win32::Console attributes and settings.
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_attr_orig&#39;</span><span class="pun">}</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># Original console attributes STDOUT [used by function Write()].</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_in_attr_orig&#39;</span><span class="pun">}</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># Original console attributes STDIN  [used by function Write()].</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_title_orig&#39;</span><span class="pun">}</span><span class="pln">     </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># Original display title</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_title_ZHex&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># Console window title (displayed in title bar).</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_codep_in&#39;</span><span class="pun">}</span><span class="pln">       </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># ...</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_codep_out&#39;</span><span class="pun">}</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># ...</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_cols&#39;</span><span class="pun">}</span><span class="pln">       </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># (X/Col) Current size console buffer.</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_rows&#39;</span><span class="pun">}</span><span class="pln">       </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># (Y/Row) Current size console buffer.</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_cols_max&#39;</span><span class="pun">}</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># (X/Col) Max number columns (console window?/buffer?) given size of: buffer/font/screen.</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_rows_max&#39;</span><span class="pun">}</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># (Y/Row) Max number rows    (console window&gt;/buffer?) given size of: buffer/font/screen.</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># (X/Col) Current position cursor (console window).</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># (Y/Row) Current position cursor (console window).</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_first_col&#39;</span><span class="pun">}</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># (X/Col) Upper-left-most position (console window).</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_top_row&#39;</span><span class="pun">}</span><span class="pln">        </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># (Y/Row) Upper-left-most position (console window).</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_last_col&#39;</span><span class="pun">}</span><span class="pln">       </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># (X/Col) Lower-right-most position (console window).</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_bottom_row&#39;</span><span class="pun">}</span><span class="pln">     </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># (Y/Row) Lower-right-most position (console window).</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_cols_orig&#39;</span><span class="pun">}</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># ...</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_rows_orig&#39;</span><span class="pun">}</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># ...</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_mode_orig&#39;</span><span class="pun">}</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># ...</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_in_mode_orig&#39;</span><span class="pun">}</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">;</span><span class="pln">   </span><span class="com"># ...</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Foreground colors.
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_BLACK&#39;</span><span class="pun">}</span><span class="pln">        </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_BLACK</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_BROWN&#39;</span><span class="pun">}</span><span class="pln">        </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_BROWN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_CYAN&#39;</span><span class="pun">}</span><span class="pln">         </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_CYAN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_GRAY&#39;</span><span class="pun">}</span><span class="pln">         </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_GRAY</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_BLUE&#39;</span><span class="pun">}</span><span class="pln">         </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_BLUE</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_GREEN&#39;</span><span class="pun">}</span><span class="pln">        </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_GREEN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_LIGHTBLUE&#39;</span><span class="pun">}</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_LIGHTBLUE</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_LIGHTCYAN&#39;</span><span class="pun">}</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_LIGHTCYAN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_LIGHTGRAY&#39;</span><span class="pun">}</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_LIGHTGRAY</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_LIGHTGREEN&#39;</span><span class="pun">}</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_LIGHTGREEN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_LIGHTMAGENTA&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_LIGHTMAGENTA</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_LIGHTRED&#39;</span><span class="pun">}</span><span class="pln">     </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_LIGHTRED</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_MAGENTA&#39;</span><span class="pun">}</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_MAGENTA</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_RED&#39;</span><span class="pun">}</span><span class="pln">          </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_RED</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_WHITE&#39;</span><span class="pun">}</span><span class="pln">        </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_WHITE</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FG_YELLOW&#39;</span><span class="pun">}</span><span class="pln">       </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$FG_YELLOW</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Background colors.
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_BLACK&#39;</span><span class="pun">}</span><span class="pln">        </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_BLACK</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_BLUE&#39;</span><span class="pun">}</span><span class="pln">         </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_BLUE</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_BROWN&#39;</span><span class="pun">}</span><span class="pln">        </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_BROWN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_CYAN&#39;</span><span class="pun">}</span><span class="pln">         </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_CYAN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_GRAY&#39;</span><span class="pun">}</span><span class="pln">         </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_GRAY</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_GREEN&#39;</span><span class="pun">}</span><span class="pln">        </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_GREEN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_LIGHTBLUE&#39;</span><span class="pun">}</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_LIGHTBLUE</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_LIGHTCYAN&#39;</span><span class="pun">}</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_LIGHTCYAN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_LIGHTGRAY&#39;</span><span class="pun">}</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_LIGHTGRAY</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_LIGHTGREEN&#39;</span><span class="pun">}</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_LIGHTGREEN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_LIGHTMAGENTA&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_LIGHTMAGENTA</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_LIGHTRED&#39;</span><span class="pun">}</span><span class="pln">     </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_LIGHTRED</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_MAGENTA&#39;</span><span class="pun">}</span><span class="pln">      </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_MAGENTA</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_RED&#39;</span><span class="pun">}</span><span class="pln">          </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_RED</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_WHITE&#39;</span><span class="pun">}</span><span class="pln">        </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_WHITE</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;BG_YELLOW&#39;</span><span class="pun">}</span><span class="pln">       </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$BG_YELLOW</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Foreground intensity (increase color brightness when combined 
</span><span class="com">	# with foreground color).
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;FOREGROUND_INTENSITY&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pln">FOREGROUND_INTENSITY</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Functions: Win32::Console module wrappers.
</span><span class="com">#
</span><span class="com">#   _____________		___________						____________________________
</span><span class="com">#   Function Name		Description						Win32::Console Function Name
</span><span class="com">#   _____________		___________						____________________________
</span><span class="com">#   w32cons_init()		Initialize Win32::Console objects.			new(), Attr()
</span><span class="com">#   w32cons_clear()		Clear display console.					Cls()
</span><span class="com">#   w32cons_termcap()		Fetch/store console attrs/dimensions/buffer size.	Size(), Info()
</span><span class="com">#   w32cons_mode_get()		Fetch/store console mode.				Mode()
</span><span class="com">#   w32cons_mode_set()		Set console mode.					Mode()
</span><span class="com">#   w32cons_size_set()		Fetch/store console size, set console size.		Size()
</span><span class="com">#   w32cons_title_get()		Fetch/store console title.				Title()
</span><span class="com">#   w32cons_title_set()		Set console title.					Title()
</span><span class="com">#   w32cons_write()		Write to console.					Cursor(), Write()
</span><span class="com">#   w32cons_cursor_visible()	Set console cursor invisible.				Cursor()
</span><span class="com">#   w32cons_cursor_invisible()	Set console cursor visible.				Cursor()
</span><span class="com">#   w32cons_cursor_tleft_dsp()	...							...
</span><span class="com">#   w32cons_cursor_bleft_dsp()	...							...
</span><span class="com">#   w32cons_fg_white_bg_black()	Set foreground white, background black.			FillAttr()
</span><span class="com">#   w32cons_close()		Reset console attributes to original.			Attr()
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_init</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# This function defines keys:
</span><span class="com">	#
</span><span class="com">	#   ___				___________ 
</span><span class="com">	#   KEY				DESCRIPTION 
</span><span class="com">	#   ___				___________ 
</span><span class="com">        #   CONS			Console object (STDOUT) created by Win32::Console::new(). 
</span><span class="com">	#   CONS_IN			Console object (STDIN)  created by Win32::Console::new(). 
</span><span class="com">	#   w32cons_attr_orig		Original attributes of console (STDOUT) at beginning of program execution. 
</span><span class="com">	#   w32cons_codep_in		... 
</span><span class="com">	#   w32cons_codep_out		... 
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pln">Win32::Console</span><span class="pun">-&gt;</span><span class="typ">new</span><span class="pln"> </span><span class="pun">(</span><span class="pln">STD_OUTPUT_HANDLE</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="str">&quot;Function new() returned w/ error. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_attr_orig&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Attr</span><span class="pun">(</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="str">&quot;Function Attr() returned w/ error. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS_IN&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pln">Win32::Console</span><span class="pun">-&gt;</span><span class="typ">new</span><span class="pln"> </span><span class="pun">(</span><span class="pln">STD_INPUT_HANDLE</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="str">&quot;Function new() returned w/ error. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_codep_in&#39;</span><span class="pun">}</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="pln">Win32::Console::InputCP</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_codep_out&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pln">Win32::Console::OutputCP</span><span class="pun">(</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_clear</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Function: Cls() 
</span><span class="com">	#   Clear the console.
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Cls</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$FG_GREEN</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">$BG_BLACK</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Cls() returned w/ error. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_termcap</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# This function defines keys:
</span><span class="com">	#
</span><span class="com">	#   ___				___________ 
</span><span class="com">	#   KEY				DESCRIPTION 
</span><span class="com">	#   ___				___________ 
</span><span class="com">	#   w32cons_attr_orig		Original console attributes [used by function Write()]. 
</span><span class="com">        #   w32cons_buf_cols		(X/Col) Current size console buffer. 
</span><span class="com">	#   w32cons_buf_rows		(Y/Row) Current size console buffer. 
</span><span class="com">	#   w32cons_buf_cols_max	(X/Col) Max number columns (console window) given size of: buffer/font/screen. 
</span><span class="com">	#   w32cons_buf_rows_max	(Y/Row) Max number rows    (console window) given size of: buffer/font/screen. 
</span><span class="com">	#   w32cons_buf_cols_orig	(X/Col) Original size console buffer. 
</span><span class="com">	#   w32cons_buf_rows_orig	(Y/Row) Original size console buffer. 
</span><span class="com">	#   w32cons_curs_xpos		(X/Col) Current position of cursor (console window). 
</span><span class="com">	#   w32cons_curs_ypos		(Y/Row) Current position of cursor (console window). 
</span><span class="com">	#   w32cons_first_col		(X/Col) Upper-left-most position (console window). 
</span><span class="com">	#   w32cons_top_row		(Y/Row) Upper-left-most position (console window). 
</span><span class="com">	#   w32cons_last_col		(X/Col) Lower-right-most position (console window). 
</span><span class="com">	#   w32cons_bottom_row		(Y/Row) Lower-right-most position (console window). 
</span><span class="pln">
</span><span class="com">	#   (Ex.1) my ($x, $y) = $CONS-&gt;Size();   [Get size] 
</span><span class="com">	#   (Ex.2) $CONS-&gt;Size (80, 25);          [Set size] 
</span><span class="pln">
</span><span class="com">	# Function: Size() 
</span><span class="com">	#   Get (or set) the console buffer size. 
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_cols_orig&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_rows_orig&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Size</span><span class="pun">(</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Size() returned w/ error. Unable to determine console size. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Function: Info() 
</span><span class="com">	#   Return array (11 values) containing console related values including: 
</span><span class="com">	#     console buffer size, cursor position, current attributes, screen dimensions, and maximum size.
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_cols&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln">        </span><span class="com"># (X/Col) Current size console buffer.</span><span class="pln">
</span><span class="pln">	     </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_rows&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln">        </span><span class="com"># (Y/Row) Current size console buffer.</span><span class="pln">
</span><span class="pln">	     </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln">       </span><span class="com"># (X/Col) Current position cursor (console window).</span><span class="pln">
</span><span class="pln">	     </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln">       </span><span class="com"># (Y/Row) Current position cursor (console window).</span><span class="pln">
</span><span class="pln">	     </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_attr_orig&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln">       </span><span class="com"># Original console attributes (used by function Write()).</span><span class="pln">
</span><span class="pln">	     </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_first_col&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln">       </span><span class="com"># (X/Col) Left-most  position (console window).</span><span class="pln">
</span><span class="pln">	     </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_top_row&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln">         </span><span class="com"># (Y/Row) Upper-most position (console window).</span><span class="pln">
</span><span class="pln">	     </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_last_col&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln">        </span><span class="com"># (X/Col) Right-most position (console window).</span><span class="pln">
</span><span class="pln">	     </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_bottom_row&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln">      </span><span class="com"># (Y/Row) Lower-most position (console window).</span><span class="pln">
</span><span class="pln">	     </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_cols_max&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln">    </span><span class="com"># (X/Col) Max number columns  (console window) [based upon size of: buffer/font/screen, and terminal settings].</span><span class="pln">
</span><span class="pln">	     </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_rows_max&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln">    </span><span class="com"># (Y/Row) Max number rows     (console window) [based upon size of: buffer/font/screen, and terminal settings].</span><span class="pln">
</span><span class="pln">		</span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Info</span><span class="pun">(</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Info() returned w/ error. Unable to determine dimensions of display console. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_mode_get</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
  	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# This function defines keys:
</span><span class="com">	#
</span><span class="com">	#   ___				___________ 
</span><span class="com">	#   KEY				DESCRIPTION 
</span><span class="com">	#   ___				___________ 
</span><span class="com">        #   w32cons_mode_orig		Console mode settings before program execution (&quot;console&quot; object). 
</span><span class="com">        #   w32cons_in_mode_orig	Console mode settings before program execution (&quot;input console&quot; object).
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_mode_orig&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Mode</span><span class="pun">(</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Mode() returned w/ error. Unable to store original mode settings. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_in_mode_orig&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS_IN&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Mode</span><span class="pun">(</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Mode() returned w/ error. Unable to store original mode settings. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_mode_set</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
  	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# &quot;Modes&quot; exported by Win32::Console 
</span><span class="com">	# __________________________________ 
</span><span class="com">	#   ENABLE_LINE_INPUT 
</span><span class="com">	#   ENABLE_ECHO_INPUT 
</span><span class="com">	#   ENABLE_PROCESSED_INPUT 
</span><span class="com">	#   ENABLE_WINDOW_INPUT 
</span><span class="com">	#   ENABLE_MOUSE_INPUT 
</span><span class="com">	#   ENABLE_PROCESSED_OUTPUT 
</span><span class="com">	#   ENABLE_WRAP_AT_EOL_OUTPUT 
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS_IN&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Mode</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ENABLE_WINDOW_INPUT</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="pln">ENABLE_MOUSE_INPUT</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Mode() returned w/ error. Unable to set mode. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># REVIEW THIS FUNCTION FOR CORRECTNESS, IT LOOKS WRONG...
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_size_set</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Function: Size() 
</span><span class="com">	#   Get (or set) the console buffer size.
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Size</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_cols_max&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_buf_rows_max&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Size() returned w/ error. Unable to determine console size. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_title_get</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# This function defines keys:
</span><span class="com">	#
</span><span class="com">	#   KEY                   DESCRIPTION 
</span><span class="com">	#   ___                   ___________ 
</span><span class="com">        #   w32cons_title_orig    Original title of console window (before program execution). 
</span><span class="pln">
</span><span class="com">	# Function: Title() 
</span><span class="com">	#   Get (or set) the title of the console window. 
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_title_orig&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Title</span><span class="pun">(</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Title() returned w/ failure. Unable to retreive string w/ console window title. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_title_set</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;HASH&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_title_set() failed, argument must be hash reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_title&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_title&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	             </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_title&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_title_set() failed, value associated w/ key &#39;w32cons_title&#39; is undef/empty string&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# This function defines keys:
</span><span class="com">	#
</span><span class="com">	#   KEY              DESCRIPTION 
</span><span class="com">	#   ___              ___________ 
</span><span class="com">        #   w32cons_title    The title of the console window. 
</span><span class="pln">
</span><span class="com">	# Function: Title() 
</span><span class="com">	#   Get (or set) the title of the console window. 
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Title</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_title&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Title() returned w/ error. Unable to set the title of the console display window. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># THIS FUNCTION UNUSED AT PRESENT...
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_write</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;HASH&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_write() failed, argument must be hash reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ref&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ref&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	             </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ref&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ref&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;ARRAY&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_write() failed, value associated w/ key &#39;ref&#39; is must be array reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	             </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_write() failed, value associated w/ key &#39;xpos&#39; is must be one or more digits&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	             </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_write() failed, value associated w/ key &#39;ypos&#39; is must be one or more digits&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$ct</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">1</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">foreach</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$line</span><span class="pln"> </span><span class="pun">(</span><span class="var">@</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ref&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Function: Write() 
</span><span class="com">		#   Write characters in the console display. 
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">WriteChar</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$line</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Write() returned w/ error while writing line &quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> 
</span><span class="pln">		             </span><span class="typ">$ct</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot; at &quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;,&quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot; (x,y coords). &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pun">++</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="typ">$ct</span><span class="pun">++</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Function: w32cons_refresh_display(): 
</span><span class="com">#   A fancy version of w32cons_write().
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_refresh_display</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;HASH&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_refresh_display() failed, argument must be hash reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;ARRAY&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_refresh_display() failed, value associated w/ key &#39;dsp&#39; must be array reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_prev&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;ARRAY&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_refresh_display() failed, value associated w/ key &#39;dsp_prev&#39; must be array reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_refresh_display() failed, value of key &#39;dsp_xpad&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_refresh_display() failed, value of key &#39;dsp_ypad&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="lit">LINE_BY_LINE:</span><span class="pln"> 
</span><span class="pln">	  </span><span class="kwd">for</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$lnum</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">scalar</span><span class="pln"> </span><span class="pun">(</span><span class="var">@</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="atv">-1</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Test line from display lines array (dsp) for definedness/correct length.
</span><span class="pln">
		</span><span class="kwd">foreach</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$key</span><span class="pln"> </span><span class="pun">(</span><span class="str">&#39;dsp&#39;</span><span class="pun">,</span><span class="pln"> </span><span class="str">&#39;dsp_prev&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$key</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$key</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">				     </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$key</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			   </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">length</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$key</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_width&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
				</span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Display array &#39;&quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$key</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> 
</span><span class="pln">				    </span><span class="str">&quot;&#39; indice &#39;&quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$lnum</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> 
</span><span class="pln">				    </span><span class="str">&quot;&#39; holds string w/ wrong length (&#39;&quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;d_width&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> 
</span><span class="pln">				    </span><span class="str">&quot;&#39; chars width req&#39;d)&quot;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# Compare line currently displayed with the line which is about to be written over the top of it:
</span><span class="com">		#   - If the two lines are identical, there is no need to write this line to the display.
</span><span class="com">		#   - If the two lines are not identical, the display will need to be updated with the new line.
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_prev&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="kwd">next</span><span class="pln"> </span><span class="pln">LINE_BY_LINE</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">			# Find the offset of the first character which does not match.
</span><span class="pln">
			</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$mmofs</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">-1</span><span class="pun">;</span><span class="pln">
</span><span class="pln">			</span><span class="lit">MISMATCH_OFS:</span><span class="pln"> 
</span><span class="pln">			  </span><span class="kwd">for</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$lofs</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">length</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">				# Compare display line with previous display line, character by 
</span><span class="com">				# character until the first mismatched character is found.
</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="kwd">substr</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pun">,</span><span class="pln">      </span><span class="typ">$lofs</span><span class="pun">,</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> 
</span><span class="pln">				    </span><span class="pun">(</span><span class="kwd">substr</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_prev&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$lofs</span><span class="pun">,</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
					</span><span class="kwd">next</span><span class="pln"> </span><span class="pln">MISMATCH_OFS</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="pun">}</span><span class="pln">
</span><span class="pln">				</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
					</span><span class="typ">$mmofs</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$lofs</span><span class="pun">;</span><span class="pln">
</span><span class="pln">					</span><span class="kwd">last</span><span class="pln"> </span><span class="pln">MISMATCH_OFS</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="pun">}</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$mmofs</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">-1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
				</span><span class="kwd">warn</span><span class="pln"> </span><span class="str">&quot;Comparison of dsp line against dsp_prev found no mismatched character.&quot;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="kwd">next</span><span class="pln"> </span><span class="pln">LINE_BY_LINE</span><span class="pun">;</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">			# Find the offset of the last character which does not match (calculate the 
</span><span class="com">			# length of the substring of mismatched characters: $mismatch_len).
</span><span class="com">			#
</span><span class="com">			#   If mismatched character was found in the string comparison operation (performed above):
</span><span class="com">			#     - mismatch_ofs will be set to the offset of the first mismatched character.
</span><span class="com">			#   Otherwise:
</span><span class="com">			#     - mismatch_ofs will be set to -1.
</span><span class="com">			#     - skip this step (don&#39;t attempt to calculate length of substring of mismatched characters).
</span><span class="pln">
			</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$mmlen</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="atv">-1</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
			</span><span class="lit">MISMATCH_LEN:</span><span class="pln"> 
</span><span class="pln">			  </span><span class="kwd">for</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$lofs</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">length</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">				# Compare display line with previous display line, character by 
</span><span class="com">				# character until the first mismatched character is found.
</span><span class="pln">
				</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rofs</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">length</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="typ">$lofs</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="kwd">substr</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pun">,</span><span class="pln">      </span><span class="typ">$rofs</span><span class="pun">,</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> 
</span><span class="pln">				    </span><span class="pun">(</span><span class="kwd">substr</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_prev&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$rofs</span><span class="pun">,</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
					</span><span class="kwd">next</span><span class="pln"> </span><span class="pln">MISMATCH_LEN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="pun">}</span><span class="pln">
</span><span class="pln">				</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
					</span><span class="typ">$mmlen</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$rofs</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="typ">$mmofs</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="atv">1</span><span class="pun">;</span><span class="pln">
</span><span class="pln">					</span><span class="kwd">last</span><span class="pln"> </span><span class="pln">MISMATCH_LEN</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="pun">}</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">			# If *either* mmofs or mmlen equal -1:
</span><span class="com">			#
</span><span class="com">			#   - The length of a mismatched substring could not be determined.
</span><span class="com">			#   - Skip ahead to next display line.
</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$mmofs</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">-1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">			    </span><span class="pun">(</span><span class="typ">$mmlen</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">-1</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
				</span><span class="kwd">next</span><span class="pln"> </span><span class="pln">LINE_BY_LINE</span><span class="pun">;</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">			# Update the display console (only characters different than those already displayed).
</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">WriteChar</span><span class="pln"> 
</span><span class="pln">			      </span><span class="pun">(</span><span class="pun">(</span><span class="kwd">substr</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$lnum</span><span class="pun">]</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$mmofs</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$mmlen</span><span class="pun">)</span><span class="pun">,</span><span class="pln">   </span><span class="com"># String written to console display.</span><span class="pln">
</span><span class="pln">			       </span><span class="pun">(</span><span class="typ">$mmofs</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">,</span><span class="pln">                     </span><span class="com"># X-coordinate where string is written.</span><span class="pln">
</span><span class="pln">			       </span><span class="pun">(</span><span class="typ">$lnum</span><span class="pln">  </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln">                    </span><span class="com"># Y-coordinate where string is written.</span><span class="pln">
</span><span class="pln">			     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">			</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Call to WriteChar() returned w/ error writing string at &#39;&quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> 
</span><span class="pln">			             </span><span class="pun">(</span><span class="typ">$mmofs</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;&#39;,&#39;&quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> 
</span><span class="pln">			             </span><span class="pun">(</span><span class="typ">$lnum</span><span class="pln">  </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;&#39; (X,Y coords)&quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_cursor_invisible</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Set console cursor invisible: 
</span><span class="com">	#   Set size and visibility without affecting position.
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Cursor</span><span class="pln"> </span><span class="pun">(</span><span class="atv">-1</span><span class="pun">,</span><span class="pln"> </span><span class="atv">-1</span><span class="pun">,</span><span class="pln"> </span><span class="atv">0</span><span class="pun">,</span><span class="pln"> </span><span class="atv">0</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$function</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;Cursor&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$rv</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function &quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$function</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;() returned w/ error (undef). &quot;</span><span class="pun">,</span><span class="pln">           </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&quot;&quot;</span><span class="pun">)</span><span class="pln">  </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function &quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$function</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;() returned w/ error (empty string). &quot;</span><span class="pun">,</span><span class="pln">    </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="typ">$rv</span><span class="pun">)</span><span class="pln">      </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function &quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$function</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;() returned w/ error (evaluates false). &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$rv</span><span class="pun">)</span><span class="pln">        </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">   </span><span class="com"># Successful return value.</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">else</span><span class="pln">               </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">   </span><span class="com"># Something other than success or failure.</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_cursor_visible</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Set console cursor visible: 
</span><span class="com">	#   Set size and visibility without affecting position.
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Cursor</span><span class="pln"> </span><span class="pun">(</span><span class="atv">-1</span><span class="pun">,</span><span class="pln"> </span><span class="atv">-1</span><span class="pun">,</span><span class="pln"> </span><span class="atv">50</span><span class="pun">,</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$function</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;Cursor&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$rv</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function &quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$function</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;() returned w/ error (undef). &quot;</span><span class="pun">,</span><span class="pln">           </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&quot;&quot;</span><span class="pun">)</span><span class="pln">  </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function &quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$function</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;() returned w/ error (empty string). &quot;</span><span class="pun">,</span><span class="pln">    </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="typ">$rv</span><span class="pun">)</span><span class="pln">      </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function &quot;</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="typ">$function</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="str">&quot;() returned w/ error (evaluates false). &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$rv</span><span class="pun">)</span><span class="pln">        </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">   </span><span class="com"># Successful return value.</span><span class="pln">
</span><span class="pln">		</span><span class="kwd">else</span><span class="pln">               </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">   </span><span class="com"># Something other than success or failure.</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_cursor_tleft_dsp</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Cursor</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pun">,</span><span class="pln"> </span><span class="atv">0</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_cursor_bleft_dsp</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Cursor</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_bottom_row&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_cursor_move</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;HASH&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_cursor_move() failed, argument must be hash reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_cursor_move() failed, value of key &#39;xpos&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to w32cons_cursor_move() failed, value of key &#39;ypos&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	         </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	         </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">		    </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">			# No need to update console cursor position 
</span><span class="com">			#   (already present at the requested position).
</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">		    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">			     </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">			   </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">		    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">			     </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">			   </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Cursor</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_xpos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xpos&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_curs_ypos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ypos&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_fg_white_bg_black</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$line_num</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_bottom_row&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">		# FillAttr (attribute, number, col, row)
</span><span class="com">		#   Fills the specified number of consecutive attributes, beginning at 
</span><span class="com">		#   *col*, *row*, with the value specified in *attribute*. Returns the 
</span><span class="com">		#   number of attributes filled, or &quot;undef&quot; on errors. See also: 
</span><span class="com">		#   &quot;FillChar&quot;. 
</span><span class="com">		#     Example: 
</span><span class="com">		#       $CONSOLE-&gt;FillAttr ($FG_BLACK | $BG_BLACK, 80*25, 0, 0);
</span><span class="pln">
		</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">FillAttr</span><span class="pln"> 
</span><span class="pln">		  </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$FG_WHITE</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">$BG_BLACK</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		   </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_last_col&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		   </span><span class="atv">0</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		   </span><span class="typ">$line_num</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">w32cons_close</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# w32cons_close: Set console attributes back to original state (before program execution). 
</span><span class="pln">
</span><span class="com">	# Function: Attr() 
</span><span class="com">	#   Set attributes associated with console, and used by function Write().
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$rv</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">Attr</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_attr_orig&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">	     </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">warn</span><span class="pln"> </span><span class="pun">(</span><span class="str">&quot;Function Attr() returned w/ error. &quot;</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$!</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$^E</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Functions: Display console colorization.
</span><span class="com">#
</span><span class="com">#   ____			___________			___________
</span><span class="com">#   NAME			DESCRIPTION			WRAPPER FOR
</span><span class="com">#   ____			___________			___________
</span><span class="com">#   colorize_display()		Set ANSI-ish console colors.	FillAttr()
</span><span class="com">#   colorize_reverse()		...				FillAttr()
</span><span class="com">#   colorize_combine_attrs()	...				-
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">colorize_display</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;HASH&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_display() failed, argument must be hash reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_elements&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_elements&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_elements&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;ARRAY&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_display() failed, value associated with &#39;c_elements&#39; key must be a hash reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_display() failed, value of key &#39;dsp_xpad&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_display() failed, value of key &#39;dsp_ypad&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$lnum</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;w32cons_bottom_row&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">foreach</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$c_element</span><span class="pln"> </span><span class="pun">(</span><span class="var">@</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_elements&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$lnum</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;y&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			    </span><span class="pun">(</span><span class="typ">$lnum</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">  </span><span class="pun">(</span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;y&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ht&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
				</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">FillAttr</span><span class="pln"> 
</span><span class="pln">				  </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">colorize_combine_attrs</span><span class="pln"> </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;c_element_attr&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;attr&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">				   </span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;wd&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">				   </span><span class="pun">(</span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;x&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">				   </span><span class="pun">(</span><span class="typ">$lnum</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">colorize_reverse</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;HASH&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_reverse() failed, argument must be hash reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_elements&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_elements&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_elements&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;ARRAY&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_reverse() failed, value associated with &#39;c_elements&#39; key must be a hash reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xc&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xc&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xc&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_reverse() failed, value of key &#39;xc&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;yc&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;yc&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;yc&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_reverse() failed, value of key &#39;yc&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;width&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;width&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;width&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_reverse() failed, value of key &#39;width&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;action&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;action&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	          </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;action&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;on&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;action&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;off&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_reverse() failed, value of key &#39;action&#39; must be &#39;on&#39; or &#39;off&#39;&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Function colorize():
</span><span class="com">	#   ________	___________
</span><span class="com">	#   Argument	Description
</span><span class="com">	#   ________	___________
</span><span class="com">	#   c_elements	Active c_elements list.
</span><span class="com">	#   xc		X coordinate of block to highlight.
</span><span class="com">	#   yc		Y coordinate of block to highlight.
</span><span class="com">	#   width	Width (in characters) of area to colorize.
</span><span class="com">	#   action	[off | on], turn highlight off/on.
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$on_off</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;action&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;action&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;off&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$on_off</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;attr&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;action&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	              </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;action&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;on&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="typ">$on_off</span><span class="pun">=</span><span class="pln"> </span><span class="str">&#39;rvrs&#39;</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">foreach</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$c_element</span><span class="pln"> </span><span class="pun">(</span><span class="var">@</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_elements&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="pun">(</span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xc&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;x&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">		      </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xc&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">  </span><span class="pun">(</span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;x&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;wd&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">
		     </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;yc&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;y&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">		      </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;yc&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">  </span><span class="pun">(</span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;y&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;ht&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">
		      </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$on_off</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">		       </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$on_off</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			    </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$on_off</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			 </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$on_off</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;ARRAY&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">			# FillAttr [attribute, number, col, row] 
</span><span class="com">			#   Fills the specified number of consecutive attributes, beginning at 
</span><span class="com">			#   *col*, *row*, with the value specified in *attribute*. Returns the 
</span><span class="com">			#   number of attributes filled, or &quot;undef&quot; on errors. See also: 
</span><span class="com">			#   &quot;FillChar&quot;. 
</span><span class="com">			#   Example: 
</span><span class="com">			#     $CONSOLE-&gt;FillAttr ($FG_BLACK | $BG_BLACK, 80*25, 0, 0); 
</span><span class="pln">
			</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">FillAttr</span><span class="pln"> 
</span><span class="pln">			  </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="typ">colorize_combine_attrs</span><span class="pln"> </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;c_element_attr&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$c_element</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="typ">$on_off</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">			   </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;width&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">			   </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;xc&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">			   </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;yc&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">colorize_combine_attrs</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;HASH&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_combine_attrs() failed, argument must be hash reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;ARRAY&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to colorize_combine_attrs() failed, value associated with &#39;c_element_attr&#39; key must be array reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$attr_combined</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">		 </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;ARRAY&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$idx</span><span class="pln"> </span><span class="pun">(</span><span class="atv">0</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">scalar</span><span class="pln"> </span><span class="pun">(</span><span class="var">@</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$idx</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$idx</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">				 </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$idx</span><span class="pun">]</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			    </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$idx</span><span class="pun">]</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">			    </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$idx</span><span class="pun">]</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">				 </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$idx</span><span class="pun">]</span><span class="pln"> </span><span class="pun">}</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$idx</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
					</span><span class="typ">$attr_combined</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">					  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$idx</span><span class="pun">]</span><span class="pln"> </span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="pun">}</span><span class="pln">
</span><span class="pln">				</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
					</span><span class="typ">$attr_combined</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">					  </span><span class="pun">(</span><span class="typ">$attr_combined</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;c_element_attr&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="typ">$idx</span><span class="pun">]</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="pun">}</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$attr_combined</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com"># Functions: Mouse event handlers.
</span><span class="com">#
</span><span class="com">#   ____		___________
</span><span class="com">#   NAME		DESCRIPTION
</span><span class="com">#   ____		___________
</span><span class="com">#   lmouse()		Left  mouse button handler. Call function based upon context.
</span><span class="com">#   rmouse()		Right mouse button handler. Call function based upon context.
</span><span class="com">#   mouse_over()	Highlight character below mouse pointer, restore attributes to character at previous mouse position.
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">lmouse</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;cursor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pln">   </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;display&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pln">    </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;editor&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$xpos</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;evt&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="atv">1</span><span class="pun">]</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$ypos</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;evt&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="atv">2</span><span class="pun">]</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">@dsp_pos</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="lit">SEARCH_DSP_POS:</span><span class="pln"> 
</span><span class="pln">	  </span><span class="kwd">foreach</span><span class="pln"> </span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$pos</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">..</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> 
</span><span class="pln">	                                </span><span class="pun">(</span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_line&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> 
</span><span class="pln">	                                 </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;sz_column&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">my</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$xc</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$yc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">		  </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">dsp_coord</span><span class="pln"> 
</span><span class="pln">		    </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;curs_pos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$pos</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		       </span><span class="str">&#39;dsp_pos&#39;</span><span class="pln">  </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objEditor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_pos&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		       </span><span class="str">&#39;dsp_ypad&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">		       </span><span class="str">&#39;dsp_xpad&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="pun">(</span><span class="typ">$xpos</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$xc</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">		     </span><span class="pun">(</span><span class="typ">$xpos</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$xc</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_xpad&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">		     </span><span class="pun">(</span><span class="typ">$ypos</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$yc</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">$objDisplay</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;dsp_ypad&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">				# Cursor in &quot;line&quot; context: highlight line 
</span><span class="com">				# beginning at align_line_boundary().
</span><span class="pln">
				</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$lb_pos</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">align_line_boundary</span><span class="pln"> </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;pos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$pos</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$lb_pos</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">				            </span><span class="typ">$lb_pos</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
					</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$lb_pos</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="pun">}</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">			</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
</span><span class="com">				# Cursor in &quot;word&quot; context: highlight word 
</span><span class="com">				# beginning at align_word_boundary().
</span><span class="pln">
				</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$wb_pos</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="typ">align_word_boundary</span><span class="pln"> </span><span class="pun">(</span><span class="pun">{</span><span class="pln"> </span><span class="str">&#39;pos&#39;</span><span class="pln"> </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="typ">$pos</span><span class="pln"> </span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$wb_pos</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> 
</span><span class="pln">				            </span><span class="typ">$wb_pos</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d+?$/</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
					</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$wb_pos</span><span class="pun">;</span><span class="pln">
</span><span class="pln">				</span><span class="pun">}</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">			</span><span class="kwd">elsif</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_ctxt&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="atv">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
				</span><span class="typ">$objCursor</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;curs_pos&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$pos</span><span class="pun">;</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">			</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
				</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">undef</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">			</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
			</span><span class="kwd">last</span><span class="pln"> </span><span class="pln">SEARCH_DSP_POS</span><span class="pun">;</span><span class="pln">
</span><span class="pln">		</span><span class="pun">}</span><span class="pln">
</span><span class="pln">	</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# $self-&gt;{&#39;CONS&#39;}-&gt;FillAttr (($FG_BLACK | $BG_LIGHTMAGENTA), 1, $xpos, $ypos);
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln"> 
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">rmouse</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;obj&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;eventloop&#39;</span><span class="pun">}</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$xpos</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;evt&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="atv">1</span><span class="pun">]</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$ypos</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">$objEventLoop</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;evt&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="pun">[</span><span class="atv">2</span><span class="pun">]</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">FillAttr</span><span class="pln"> </span><span class="pun">(</span><span class="pun">(</span><span class="typ">$FG_BLACK</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">$BG_LIGHTBLUE</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> </span><span class="atv">1</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$xpos</span><span class="pun">,</span><span class="pln"> </span><span class="typ">$ypos</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="lit">sub</span><span class="pln"> </span><span class="typ">mouse_over</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$self</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">	</span><span class="kwd">my</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln">  </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">shift</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	      </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">ref</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">)</span><span class="pln"> </span><span class="pun">eq</span><span class="pln"> </span><span class="str">&#39;HASH&#39;</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to mouse_over() failed, argument must be hash reference&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_x&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_x&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_x&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to mouse_over() failed, value of key &#39;mouse_over_x&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_y&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_y&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_y&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to mouse_over() failed, value of key &#39;mouse_over_y&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_x_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_x_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_x_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to mouse_over() failed, value of key &#39;mouse_over_x_prev&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pun">!</span><span class="pln"> </span><span class="kwd">exists</span><span class="pln">  </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_y_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">!</span><span class="pln"> </span><span class="kwd">defined</span><span class="pln"> </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_y_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> 
</span><span class="pln">	           </span><span class="pun">!</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_y_prev&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=~</span><span class="pln"> </span><span class="str">/^\d\d?\d?$/</span><span class="pun">)</span><span class="pun">)</span><span class="pln"> 
</span><span class="pln">		</span><span class="pun">{</span><span class="pln"> </span><span class="kwd">die</span><span class="pln"> </span><span class="str">&quot;Call to mouse_over() failed, value of key &#39;mouse_over_y_prev&#39; must be numeric&quot;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# Restore original attributes to character at previous mouseover X,Y coordinate.
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">WriteAttr</span><span class="pln"> 
</span><span class="pln">	  </span><span class="pun">(</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_attr&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_x_prev&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_y_prev&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# ReadChar [number, col, row]
</span><span class="com">	#   Reads the specified *number* of consecutive characters, beginning at
</span><span class="com">	#   *col*, *row*, from the console. Returns a string containing the
</span><span class="com">	#   characters read, or &quot;undef&quot; on errors. You can then pass the
</span><span class="com">	#   returned variable to &quot;WriteChar&quot; to restore the saved characters on
</span><span class="com">	#   screen. See also: &quot;ReadAttr&quot;, &quot;ReadRect&quot;.
</span><span class="com">	# 
</span><span class="com">	#   Example:
</span><span class="com">	#     $chars = $CONSOLE-&gt;ReadChar (80 * 25, 0, 0);
</span><span class="pln">
</span><span class="com">	# Read/store character underneath mouse pointer.
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_char&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">	  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">ReadChar</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">(</span><span class="atv">1</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	     </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_x&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	     </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_y&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# ReadAttr (number, col, row)
</span><span class="com">	#   Reads the specified *number* of consecutive attributes, beginning at
</span><span class="com">	#   *col*, *row*, from the console. Returns the attributes read (a
</span><span class="com">	#   variable containing one character for each attribute), or &quot;undef&quot; on
</span><span class="com">	#   errors. You can then pass the returned variable to &quot;WriteAttr&quot; to
</span><span class="com">	#   restore the saved attributes on screen. See also: &quot;ReadChar&quot;,
</span><span class="com">	#   &quot;ReadRect&quot;.
</span><span class="com">	# 
</span><span class="com">	#     Example:
</span><span class="com">	#       $colors = $CONSOLE-&gt;ReadAttr(80*25, 0, 0);
</span><span class="pln">
</span><span class="com">	# Read/store attributes of character underneath mouse pointer
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_attr&#39;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> 
</span><span class="pln">	  </span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">ReadAttr</span><span class="pln"> 
</span><span class="pln">	    </span><span class="pun">(</span><span class="atv">1</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	     </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_x&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	     </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_y&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="com">	# WriteAttr (attrs, col, row)
</span><span class="com">	#   Writes the attributes in the string *attrs*, beginning at *col*,
</span><span class="com">	#   *row*, without affecting the characters that are on screen. The
</span><span class="com">	#   string attrs can be the result of a &quot;ReadAttr&quot; function, or you can
</span><span class="com">	#   build your own attribute string; in this case, keep in mind that
</span><span class="com">	#   every attribute is treated as a character, not a number (see
</span><span class="com">	#   example). Returns the number of attributes written or &quot;undef&quot; on
</span><span class="com">	#   errors. See also: &quot;Write&quot;, &quot;WriteChar&quot;, &quot;WriteRect&quot;.
</span><span class="com">	# 
</span><span class="com">	#   Example:
</span><span class="com">	#     $CONSOLE-&gt;WriteAttr ($attrs, 0, 0);
</span><span class="com">	# 
</span><span class="com">	#   Note the use of chr()...
</span><span class="com">	#     $attrs = chr ($FG_BLACK | $BG_WHITE) x 80;
</span><span class="com">	#     $CONSOLE-&gt;WriteAttr ($attrs, 0, 0);
</span><span class="pln">
</span><span class="com">	# Hi-light character underneath mouse pointer.
</span><span class="pln">
	</span><span class="typ">$self</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;CONS&#39;</span><span class="pun">}</span><span class="pun">-&gt;</span><span class="typ">WriteAttr</span><span class="pln"> 
</span><span class="pln">	  </span><span class="pun">(</span><span class="kwd">chr</span><span class="pln"> </span><span class="pun">(</span><span class="typ">$FG_BLACK</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="typ">$BG_LIGHTRED</span><span class="pun">)</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_x&#39;</span><span class="pun">}</span><span class="pun">,</span><span class="pln"> 
</span><span class="pln">	   </span><span class="typ">$arg</span><span class="pun">-&gt;</span><span class="pun">{</span><span class="str">&#39;mouse_over_y&#39;</span><span class="pun">}</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="atv">1</span><span class="pun">)</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">END</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">undef</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="atv">1</span><span class="pun">;</span><span class="pln">
</span><span class="pln">
</span><span class="pln">
</span><span class="kwd">__END__</span><span class="pln">
</span><span class="com">

</span><span class="com">=head1 NAME

ZHex::Console (ZHex/Console.pm) - Console Module, ZebraHex Editor.

=head1 VERSION

Version 0.01

=cut
</span><span class="com">
our $VERSION = &#39;0.01&#39;;

</span><span class="com">=head1 SYNOPSIS

The ZHex::Console module is a wrapper around the functions provided by 
Win32::Console. It serves to make the use of Win32::Console easier for the 
author.

Usage:

    use ZHex::BoilerPlate qw(new obj_init $VERS);
    my $objConsole = $self-&gt;{&#39;obj&#39;}-&gt;{&#39;console&#39;};
    $objConsole-&gt;w32cons_cursor_invisible();

=head1 EXPORT

No functions are exported.

=head1 SUBROUTINES/METHODS

=head2 colorize_combine_attrs
Method colorize_combine_attrs()...
= cut

=head2 colorize_display
Method colorize_display()...
= cut

=head2 colorize_reverse
Method colorize_reverse()...
= cut

=head2 init
Method init()...
= cut

=head2 lmouse
Method lmouse()...
= cut

=head2 mouse_over
Method mouse_over()...
= cut

=head2 rmouse
Method rmouse()...
= cut

=head2 w32cons_clear
Method w32cons_clear()...
= cut

=head2 w32cons_close
Method w32cons_close()...
= cut

=head2 w32cons_cursor_bleft_dsp
Method w32cons_cursor_bleft_dsp()...
= cut

=head2 w32cons_cursor_invisible
Method w32cons_cursor_invisible()...
= cut

=head2 w32cons_cursor_move
Method w32cons_cursor_move()...
= cut

=head2 w32cons_cursor_tleft_dsp
Method w32cons_cursor_tleft_dsp()...
= cut

=head2 w32cons_cursor_visible
Method w32cons_cursor_visible()...
= cut

=head2 w32cons_fg_white_bg_black
Method w32cons_fg_white_bg_black()...
= cut

=head2 w32cons_init
Method w32cons_init()...
= cut

=head2 w32cons_mode_get
Method w32cons_mode_get()...
= cut

=head2 w32cons_mode_set
Method w32cons_mode_set()...
= cut

=head2 w32cons_refresh_display
Method w32cons_refresh_display()...
= cut

=head2 w32cons_size_set
Method w32cons_size_set()...
= cut

=head2 w32cons_termcap
Method w32cons_termcap()...
= cut

=head2 w32cons_title_get
Method w32cons_title_get()...
= cut

=head2 w32cons_title_set
Method w32cons_title_set()...
= cut

=head2 w32cons_write
Method w32cons_write()...
= cut

=head1 AUTHOR

Double Z, C&lt;&lt; &lt;zacharyz at gmail.com&gt; &gt;&gt;

=head1 BUGS

Please report any bugs or feature requests to C&lt;bug-ZHex at rt.cpan.org&gt;, or 
via the web interface: L&lt;http://rt.cpan.org/NoAuth/ReportBug.html?Queue=ZHex&gt;.  
I will be notified, and then you&#39;ll automatically be notified of progress on 
your bug as I make changes.

=head1 SUPPORT

You can find documentation for this module with the perldoc command.

    perldoc ZHex

You can also look for information at:

=over 4

=item * RT: CPAN&#39;s request tracker (report bugs here)

L&lt;http://rt.cpan.org/NoAuth/Bugs.html?Dist=ZHex&gt;

=item * AnnoCPAN: Annotated CPAN documentation

L&lt;http://annocpan.org/dist/ZHex&gt;

=item * CPAN Ratings

L&lt;http://cpanratings.perl.org/d/ZHex&gt;

=item * Search CPAN

L&lt;http://search.cpan.org/dist/ZHex/&gt;

=back

=head1 ACKNOWLEDGEMENTS

=head1 LICENSE AND COPYRIGHT

Copyright 2014 Double Z.

This program is free software; you can redistribute it and/or modify it
under the terms of the the Artistic License (2.0). You may obtain a
copy of the full license at:

L&lt;http://www.perlfoundation.org/artistic_license_2_0&gt;

Any use, modification, and distribution of the Standard or Modified
Versions is governed by this Artistic License. By using, modifying or
distributing the Package, you accept this license. Do not use, modify,
or distribute the Package, if you do not accept this license.

If your Modified Version has been derived from a Modified Version made
by someone other than you, you are nevertheless required to ensure that
your Modified Version complies with the requirements of this license.

This license does not grant you the right to use any trademark, service
mark, tradename, or logo of the Copyright Holder.

This license includes the non-exclusive, worldwide, free-of-charge
patent license to make, have made, use, offer to sell, sell, import and
otherwise transfer the Package with respect to any patent claims
licensable by the Copyright Holder that are necessarily infringed by the
Package. If you institute patent litigation (including a cross-claim or
counterclaim) against any party alleging that the Package constitutes
direct or contributory patent infringement, then this Artistic License
to you shall terminate on the date that such litigation is filed.

Disclaimer of Warranty: THE PACKAGE IS PROVIDED BY THE COPYRIGHT HOLDER
AND CONTRIBUTORS &quot;AS IS&#39; AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES.
THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
PURPOSE, OR NON-INFRINGEMENT ARE DISCLAIMED TO THE EXTENT PERMITTED BY
YOUR LOCAL LAW. UNLESS REQUIRED BY LAW, NO COPYRIGHT HOLDER OR
CONTRIBUTOR WILL BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, OR
CONSEQUENTIAL DAMAGES ARISING IN ANY WAY OUT OF THE USE OF THE PACKAGE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

=cut
</span><span class="com">
1;

</span></pre></div>
</body>
</html>

